<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-194688-3"></script>
  <script>
   window.dataLayer = window.dataLayer || [];
   function gtag(){dataLayer.push(arguments);}
   gtag('js', new Date());
   gtag('config', 'UA-194688-3');
  </script>
  <meta content="Evasion techniques" property="og:site_name">

  <meta content="Evasions: CPU" property="og:title">


  <meta name="twitter:title" content="Malware Evasion Encyclopedia" />
  <meta name="twitter:image" content="https://research.checkpoint.com/wp-content/uploads/2020/02/evasions.jpg" />


  <meta content="article" property="og:type">


  <meta content="Evasion techniques
" property="og:description">


  <meta content="https://evasions.checkpoint.com/src/Evasions/techniques/cpu.html" property="og:url">


  <meta content="2024-07-10T07:20:28+00:00" property="article:published_time">
  <meta content="https://evasions.checkpoint.com/about/" property="article:author">


  <meta property="og:image" content="">


  
  <meta content="evasions" property="article:section">
  


  
  <meta content="cpu" property="article:tag">
  

  <title>Evasions: CPU</title>
  <meta name="description" content="Contents">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://evasions.checkpoint.com/assets/css/main.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

  <link href='https://fonts.googleapis.com/css?family=PT+Sans' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Fira+Mono' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,200,300,500,600,700,900' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Gentium+Basic:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Alegreya:400,400italic,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Lora:400,400italic,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Fira+Sans:400,300,500,700' rel='stylesheet' type='text/css'>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-hQpvDQiCJaD2H465dQfA717v7lu5qHWtDbWNPvaTJ0ID5xnPUlVXnKzq7b8YUkbN" crossorigin="anonymous">
  <link rel="canonical" href="https://evasions.checkpoint.com/src/Evasions/techniques/cpu.html">
  <link rel="alternate" type="application/rss+xml" title="Evasion techniques" href="https://evasions.checkpoint.com/feed.xml">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/tinysort/2.3.6/tinysort.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tinysort/2.3.6/tinysort.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tinysort/2.3.6/tinysort.charorder.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tinysort/2.3.6/tinysort.charorder.min.js"></script>
  <script type="text/javascript" async src="//platform.twitter.com/widgets.js"></script>




</head>


  <body>
<section>
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <div class="jumbotron">
    <div class="container">
      <h1 class="post-title-main" itemprop="name headline">Evasions: CPU</h1>
    </div>
</div>

  <div class="post-content container" itemprop="articleBody">
    <div style="text-align: left">
        <a href="..">Go back</a>
        <br>
        <br>
    </div>
    <h1>Contents</h1>

<p><a href="#cpu-detection-methods">CPU detection methods used</a>
<br />
  <a href="#check-vendor-id-via-cpuid">1. Check vendor ID string via CPUID instruction</a>
<br />
  <a href="#check-if-being-run-in-Hypervisor-via-cpuid">2. Check if being run in Hypervisor via CPUID instruction</a>
<br />
  <a href="#check-for-global-tables-location">3. Check for global tables location: IDT/GDT/LDT</a>
<br />
  <a href="#using-exotic-instructions-to-fool-virtual-emulators">4. Using exotic instructions to fool virtual emulators</a>
<br />
  <a href="#detecting-environment-via-illegal-instructions-virtualpc">5. Detecting environment via execution of illegal instructions (VirtualPC only)</a>
<br />
  <a href="#detecting-environment-via-in-backdoor-port-vmware">6. Detecting environment via IN instruction - backdoor port (VMware only)</a>
<br />
  <a href="#signature-recommendations">Signature recommendations</a>
<br />
  <a href="#countermeasures-sandboxie">Countermeasures</a>
<br />
  <a href="#credits">Credits</a>
<br />
<br /></p>

<hr class="space" />

<h2><a class="a-dummy" name="cpu-detection-methods">CPU detection methods used</a></h2>
<p>Techniques in this group use specific processor instructions to either get particular information about CPU — or execute predefined instruction sequence which behaves differently in usual host OS and in virtual environment.</p>

<p><br /></p>
<h3><a class="a-dummy" name="check-vendor-id-via-cpuid">1. Check vendor ID string via CPUID instruction</a></h3>
<p>The <a href="https://x86.renejeschke.de/html/file_module_x86_id_45.html">CPUID</a> instruction is an instruction that returns processor identification and feature information to <tt>EBX, ECX, EDX</tt>. The information received to these registers can be used to identify a vendor.</p>

<hr class="space" />

<p><b>Code sample</b></p>
<p></p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="kr">__declspec</span><span class="p">(</span><span class="kr">naked</span><span class="p">)</span> <span class="kt">void</span> <span class="nf">get_cpuid_vendor</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">vendor_id</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">__asm</span> <span class="p">{</span>        
    <span class="p">;</span> <span class="n">save</span> <span class="n">non</span><span class="o">-</span><span class="k">volatile</span> <span class="k">register</span>
    <span class="n">push</span> <span class="n">ebx</span>
    
    <span class="p">;</span> <span class="n">nullify</span> <span class="n">output</span> <span class="n">registers</span>
    <span class="n">xor</span> <span class="n">ebx</span><span class="p">,</span> <span class="n">ebx</span>
    <span class="n">xor</span> <span class="n">ecx</span><span class="p">,</span> <span class="n">ecx</span>
    <span class="n">xor</span> <span class="n">edx</span><span class="p">,</span> <span class="n">edx</span>
    
    <span class="p">;</span> <span class="n">call</span> <span class="n">cpuid</span> <span class="n">with</span> <span class="n">argument</span> <span class="n">in</span> <span class="n">EAX</span>
    <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mh">0x40000000</span>
    <span class="n">cpuid</span>
    
    <span class="p">;</span> <span class="n">store</span> <span class="n">vendor_id</span> <span class="n">ptr</span> <span class="n">to</span> <span class="n">destination</span>
    <span class="n">mov</span> <span class="n">edi</span><span class="p">,</span> <span class="n">vendor_id</span>
    
    <span class="p">;</span> <span class="n">move</span> <span class="n">string</span> <span class="n">parts</span> <span class="n">to</span> <span class="n">destination</span>
    <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">ebx</span>  <span class="p">;</span> <span class="n">part</span> <span class="mi">1</span> <span class="n">of</span> <span class="mi">3</span> <span class="n">from</span> <span class="n">EBX</span>
    <span class="n">stosd</span>
    <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">ecx</span>  <span class="p">;</span> <span class="n">part</span> <span class="mi">2</span> <span class="n">of</span> <span class="mi">3</span> <span class="n">from</span> <span class="n">ECX</span>
    <span class="n">stosd</span>
    <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">edx</span>  <span class="p">;</span> <span class="n">part</span> <span class="mi">3</span> <span class="n">of</span> <span class="mi">3</span> <span class="n">from</span> <span class="n">EDX</span>
    <span class="n">stosd</span>
    
    <span class="p">;</span> <span class="n">restore</span> <span class="n">saved</span> <span class="n">non</span><span class="o">-</span><span class="k">volatile</span> <span class="k">register</span>
    <span class="n">pop</span> <span class="n">ebx</span> 
    
    <span class="p">;</span> <span class="k">return</span> <span class="n">from</span> <span class="n">function</span>
    <span class="n">retn</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<hr class="space" />

<p><b>Detections table</b></p>

<table style="width:70%">
  <tr>
    <td colspan="3">Check vendor ID string via CPUID instruction - returned in parts in EBX, ECX, EDX:</td>
  </tr>
  <tr>
    <th style="text-align:center">Detect</th>
    <th style="text-align:center">EAX as argument to CPUID</th>
    <th style="text-align:center">String</th>
  </tr>
  <tr>
    <th>FreeBSD HV</th>
    <td>0x40000000</td>
    <td>bhyve bhyve</td>
  </tr>
  <tr>
    <th>Hyper-V</th>
    <td>0x40000000</td>
    <td>Microsoft Hv</td>
  </tr>
  <tr>
    <th>KVM</th>
    <td>0x40000000</td>
    <td>KVMKVMKVM</td>
  </tr>
  <tr>
    <th>Parallels</th>
    <td>0x40000000</td>
    <td>prl hyperv</td>
  </tr>
  <tr>
    <th>VirtualBox</th>
    <td>0x40000000</td>
    <td>VBoxVBoxVBox</td>
  </tr>
  <tr>
    <th>VirtualPC</th>
    <td>0x40000000</td>
    <td>Microsoft Hv</td>
  </tr>
  <tr>
    <th>VMware</th>
    <td>0x40000000</td>
    <td>VMwareVMware</td>
  </tr>
  <tr>
    <th>Xen</th>
    <td>0x40000000</td>
    <td>XenVMMXenVMM</td>
  </tr>
</table>

<p><br /></p>
<h3><a class="a-dummy" name="check-if-being-run-in-Hypervisor-via-cpuid">2. Check if being run in Hypervisor via CPUID instruction</a></h3>

<p>An other way to detect if the program is being run in hypervisor is using the <tt>CPUID</tt> instruction in an other way.
<br />
<br />
Instead of setting <tt>EAX</tt> (the argument to <tt>CPUID</tt>) to be <tt>0x40000000</tt>, <tt>EAX</tt> is set to 1. 
<br />
<br />
When <tt>EAX</tt> is set to 1, the 31st bit in <tt>ECX</tt> (<tt>CPUID</tt>’s returned value) is set, it indicates that the program is being run in Hypervisor.</p>

<hr class="space" />

<p><b>Code sample (function <tt>GetAdaptersAddresses</tt>)</b></p>
<p></p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="kr">__declspec</span><span class="p">(</span><span class="kr">naked</span><span class="p">)</span> <span class="n">bool</span> <span class="nf">is_run_in_hypervisor</span><span class="p">()</span> <span class="p">{</span>
  <span class="kr">__asm</span> <span class="p">{</span>
    <span class="p">;</span> <span class="n">nullify</span> <span class="n">output</span> <span class="k">register</span>
    <span class="n">xor</span> <span class="n">ecx</span><span class="p">,</span> <span class="n">ecx</span>
    
    <span class="p">;</span> <span class="n">call</span> <span class="n">cpuid</span> <span class="n">with</span> <span class="n">argument</span> <span class="n">in</span> <span class="n">EAX</span>
    <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mi">1</span>
    <span class="n">cpuid</span>
    
    <span class="p">;</span> <span class="n">set</span> <span class="n">CF</span> <span class="n">equal</span> <span class="n">to</span> <span class="mi">31</span><span class="n">st</span> <span class="n">bit</span> <span class="n">in</span> <span class="n">ECX</span>
    <span class="n">bt</span> <span class="n">ecx</span><span class="p">,</span> <span class="mi">31</span>
    
    <span class="p">;</span> <span class="n">set</span> <span class="n">AL</span> <span class="n">to</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">CF</span>
    <span class="n">setc</span> <span class="n">al</span>
    
    <span class="p">;</span> <span class="k">return</span> <span class="n">from</span> <span class="n">function</span>
    <span class="n">retn</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<hr class="space" />

<p><b>Detections table</b></p>

<table style="width:70%">
  <tr>
    <td colspan="3">Check if being run in Hypervisor (via CPUID)</td>
  </tr>
  <tr>
    <th style="text-align:center">Detect</th>
    <th style="text-align:center">EAX as argument to CPUID</th>
    <th style="text-align:center">Check of return value</th>
  </tr>
  <tr>
    <th>Hypervisor</th>
    <td>1</td>
    <td>31st bit in ECX - set if run in Hypervisor</td>
  </tr>
</table>

<p><br /></p>
<h3><a class="a-dummy" name="check-for-global-tables-location">3. Check for global tables location: IDT/GDT/LDT</a></h3>

<p><i>
This technique doesn’t work on latest VMware releases (all Windows releases affected). However, it is described here for the sake of completeness.
</i>
<br />
<br /></p>

<p>This trick involves looking at  the pointers to critical operating system tables that are typically relocated on a virtual machine. It’s what called “Red Pill” and was <a href="http://web.archive.org/web/20070325211649/http://www.invisiblethings.org/papers/redpill.html">first introduced</a> by Joanna Rutkowska.
<br />
<br />
There is one Local Descriptor Table Register (LDTR), one Global Descriptor Table Register (GDTR), and one Interrupt Descriptor Table Register (IDTR) per CPU. They have to be moved to a different location when a guest operating system is running to avoid conflicts with the host.
<br />
<br />
On real machines the IDT, for example, is located lower in memory than it is on guest (i.e., virtual) machines.
<br /></p>

<hr class="space" />

<p><b>Code sample</b></p>
<p></p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">idt_vm_detect</span> <span class="o">=</span> <span class="p">((</span><span class="n">get_idt_base</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xff</span><span class="p">);</span>
<span class="n">ldt_vm_detect</span> <span class="o">=</span> <span class="p">(</span><span class="n">get_ldt_base</span><span class="p">()</span> <span class="o">==</span> <span class="mh">0xdead0000</span><span class="p">);</span>
<span class="n">gdt_vm_detect</span> <span class="o">=</span> <span class="p">((</span><span class="n">get_gdt_base</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xff</span><span class="p">);</span>

<span class="c1">// sidt instruction stores the contents of the IDT Register </span>
<span class="c1">// (the IDTR which points to the IDT) in a processor register.</span>
<span class="n">ULONG</span> <span class="nf">get_idt_base</span><span class="p">()</span> <span class="p">{</span>    
    <span class="n">UCHAR</span> <span class="n">idtr</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="cp">#if defined (ENV32BIT)
</span>    <span class="n">_asm</span> <span class="n">sidt</span> <span class="n">idtr</span>
<span class="cp">#endif
</span>    <span class="k">return</span> <span class="o">*</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">idtr</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
<span class="p">}</span>

<span class="c1">// sldt instruction stores the contents of the LDT Register </span>
<span class="c1">// (the LDTR which points to the LDT) in a processor register.</span>
<span class="n">ULONG</span> <span class="nf">get_ldt_base</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">UCHAR</span> <span class="n">ldtr</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="s">"</span><span class="se">\xef\xbe\xad\xde</span><span class="s">"</span><span class="p">;</span>
<span class="cp">#if defined (ENV32BIT)
</span>    <span class="n">_asm</span> <span class="n">sldt</span> <span class="n">ldtr</span>
<span class="cp">#endif
</span>    <span class="k">return</span> <span class="o">*</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ldtr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">}</span>

<span class="c1">// sgdt instruction stores the contents of the GDT Register </span>
<span class="c1">// (the GDTR which points to the GDT) in a processor register.</span>
<span class="n">ULONG</span> <span class="nf">get_gdt_base</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">UCHAR</span> <span class="n">gdtr</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="cp">#if defined (ENV32BIT)
</span>    <span class="n">_asm</span> <span class="n">sgdt</span> <span class="n">gdtr</span>
<span class="cp">#endif
</span>    <span class="k">return</span> <span class="n">gdt</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">gdtr</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
<span class="p">}</span></code></pre></figure>

<p><i>Credits for this code sample: <a href="https://github.com/LordNoteworthy/al-khaser">al-khaser project</a></i></p>

<p><br /></p>
<h3><a class="a-dummy" name="using-exotic-instructions-to-fool-virtual-emulators">4. Using exotic instructions to fool virtual emulators</a></h3>

<p>This technique is described <a href="https://www.slideshare.net/Cyphort/mmw-antisandbox-techniques">by this link</a> (slide #37).
<br />
<br />
MMX instructions may be used as random instructions by malware. Sometimes such subsets of CPU instruction are not supported by emulators and thus exception is thrown instead of performing analysis.</p>

<hr class="space" />

<p><b>Example:</b></p>
<p></p>

<div style="text-align: center">
  <img src="../assets/images/mmx_anti_sb.png" />
</div>

<p><br /></p>
<h3><a class="a-dummy" name="detecting-environment-via-illegal-instructions-virtualpc">5. Detecting environment via execution of illegal instructions (VirtualPC only)</a></h3>

<p>The malware executes illegal instructions, which should generate exception on the real CPU but are executed normally - or in some different way - in virtual environment.
<br />
<br />
Information about CPU exceptions is provided <a href="https://wiki.osdev.org/Exceptions#Invalid_Opcode">by this link</a>.</p>

<hr class="space" />

<p><b>Code sample (variant 1, generating #ud exception)</b></p>
<p></p>

<figure class="highlight"><pre><code class="language-asm" data-lang="asm">push ebx
xor ebx, ebx
mov eax, 1
; the following 4 bytes below generate #ud exception
db 0x0F
db 0x3F
db 0x0D
db 0x00
test ebx, ebx
setz al
pop ebx</code></pre></figure>

<hr class="space" />

<p>It should be emphasized that there are more than 1,000 combinations of</p>

<figure class="highlight"><pre><code class="language-asm" data-lang="asm">0x0F
0x3F
0xXX
0xYY</code></pre></figure>

<p>bytes that may be used by malware in order to detect VirtualPC enviroment.</p>

<hr class="space" />

<p><b>Code sample (variant 2, executing illegal STI instruction)</b></p>
<p></p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="c1">// Taken here: https://pastebin.com/Nsv5B1yk</span>
<span class="c1">// http://waleedassar.blogspot.com</span>
<span class="c1">// http://www.twitter.com/waleedassar</span>
<span class="c1">// Use this code to detect if Windows XP is running inside Virtual PC 2007</span>
<span class="cp">#include</span> <span class="cpf">"stdafx.h"</span><span class="cp">
#include</span> <span class="cpf">"windows.h"</span><span class="cp">
#include</span> <span class="cpf">"stdio.h"</span><span class="cp">
</span> 
<span class="cp">#define CONTEXT_ALL 0x1003F
</span> 
<span class="kt">int</span> <span class="nf">dummy</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">gf</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">Handler</span><span class="p">(</span><span class="n">EXCEPTION_RECORD</span><span class="o">*</span> <span class="n">pRec</span><span class="p">,</span><span class="kt">void</span><span class="o">*</span> <span class="n">est</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">pContext</span><span class="p">,</span><span class="kt">void</span><span class="o">*</span> <span class="n">disp</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">pRec</span><span class="o">-&gt;</span><span class="n">ExceptionCode</span><span class="o">==</span><span class="mh">0xC0000096</span><span class="p">)</span>  <span class="c1">//Privileged instruction</span>
    <span class="p">{</span>
        <span class="c1">//---------------------Installing the trick--------------------------------------</span>
        <span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="o">*</span><span class="p">)(</span><span class="n">pContext</span><span class="p">)</span><span class="o">=</span><span class="n">CONTEXT_ALL</span><span class="p">;</span><span class="cm">/*CONTEXT_DEBUG_REGISTERS|CONTEXT_FULL*/</span>
        <span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="o">*</span><span class="p">)(</span><span class="n">pContext</span><span class="o">+</span><span class="mh">0x4</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)(</span><span class="o">&amp;</span><span class="n">dummy</span><span class="p">);</span>
        <span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="o">*</span><span class="p">)(</span><span class="n">pContext</span><span class="o">+</span><span class="mh">0x8</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)(</span><span class="o">&amp;</span><span class="n">dummy</span><span class="p">);</span>
        <span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="o">*</span><span class="p">)(</span><span class="n">pContext</span><span class="o">+</span><span class="mh">0xC</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)(</span><span class="o">&amp;</span><span class="n">dummy</span><span class="p">);</span>
        <span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="o">*</span><span class="p">)(</span><span class="n">pContext</span><span class="o">+</span><span class="mh">0x10</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)(</span><span class="o">&amp;</span><span class="n">dummy</span><span class="p">);</span>
        <span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="o">*</span><span class="p">)(</span><span class="n">pContext</span><span class="o">+</span><span class="mh">0x14</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="o">*</span><span class="p">)(</span><span class="n">pContext</span><span class="o">+</span><span class="mh">0x18</span><span class="p">)</span><span class="o">=</span><span class="mh">0x155</span><span class="p">;</span> <span class="c1">//Enable the four DRx On-Execute</span>
        <span class="c1">//---------------------------------------------------------------------------------</span>
        <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="o">*</span><span class="p">)(</span><span class="n">pContext</span><span class="o">+</span><span class="mh">0xB8</span><span class="p">))</span><span class="o">++</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">ExceptionContinueExecution</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">pRec</span><span class="o">-&gt;</span><span class="n">ExceptionCode</span><span class="o">==</span><span class="n">EXCEPTION_SINGLE_STEP</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">gf</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">MessageBox</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s">"Expected behavior (XP)"</span><span class="p">,</span><span class="s">"waliedassar"</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
            <span class="n">ExitProcess</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">gf</span><span class="o">++</span><span class="p">;</span>
        <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="o">*</span><span class="p">)(</span><span class="n">pContext</span><span class="o">+</span><span class="mh">0xC0</span><span class="p">))</span><span class="o">|=</span><span class="mh">0x00010000</span><span class="p">;</span> <span class="c1">//Set the RF (Resume Flag)</span>
        <span class="k">return</span> <span class="n">ExceptionContinueExecution</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ExceptionContinueSearch</span><span class="p">;</span>
<span class="p">}</span>
 
<span class="kt">int</span> <span class="nf">dummy</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">x</span><span class="o">+=</span><span class="mh">0x100</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
 
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">shitArg</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ver_</span><span class="o">=</span><span class="n">GetVersion</span><span class="p">();</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">major</span><span class="o">=</span><span class="n">ver_</span><span class="o">&amp;</span><span class="mh">0xFF</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">minor</span><span class="o">=</span><span class="p">(</span><span class="n">ver_</span><span class="o">&gt;&gt;</span><span class="mh">0x8</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFF</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">major</span><span class="o">==</span><span class="mh">0x05</span> <span class="o">&amp;</span> <span class="n">minor</span><span class="o">==</span><span class="mh">0x01</span><span class="p">)</span> <span class="c1">//Windows XP</span>
    <span class="p">{</span>
        <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="kr">__asm</span>
        <span class="p">{</span>
            <span class="n">push</span> <span class="n">offset</span> <span class="n">Handler</span>
            <span class="n">push</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">fs</span><span class="o">:</span><span class="p">[</span><span class="mh">0x0</span><span class="p">]</span>
            <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">fs</span><span class="o">:</span><span class="p">[</span><span class="mh">0x0</span><span class="p">],</span><span class="n">esp</span>
            <span class="n">STI</span><span class="p">;</span> <span class="n">Triggers</span> <span class="n">an</span> <span class="n">exception</span><span class="p">(</span><span class="n">privileged</span> <span class="n">instruction</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">dummy</span><span class="p">(</span><span class="mh">0xFF</span><span class="p">);</span>
        <span class="kr">__asm</span>
        <span class="p">{</span>
            <span class="n">pop</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">fs</span><span class="o">:</span><span class="p">[</span><span class="mh">0x0</span><span class="p">]</span>
            <span class="n">pop</span> <span class="n">ebx</span>
        <span class="p">}</span>
        <span class="n">MessageBox</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s">"Virtual PC 2007 detected (XP)"</span><span class="p">,</span><span class="s">"waliedassar"</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<hr class="space" />

<p><b>Code sample (variant 3, resetting VirtualPC)</b></p>
<p></p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="c1">// Taken here: https://pastebin.com/exAK5XQx</span>
<span class="c1">// http://waleedassar.blogspot.com (@waleedassar)</span>
<span class="c1">// Executing "\x0F\xC7\xC8\x05\x00" in VirtualPC 2007 triggers a reset error.</span>
<span class="cp">#include</span> <span class="cpf">"stdafx.h"</span><span class="cp">
#include</span> <span class="cpf">"windows.h"</span><span class="cp">
#include</span> <span class="cpf">"stdio.h"</span><span class="cp">
</span> 
<span class="n">bool</span> <span class="n">flag</span><span class="o">=</span><span class="nb">false</span><span class="p">;</span>
 
<span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">Handler</span><span class="p">(</span><span class="n">EXCEPTION_RECORD</span><span class="o">*</span> <span class="n">pRec</span><span class="p">,</span><span class="kt">void</span><span class="o">*</span> <span class="n">est</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">pContext</span><span class="p">,</span><span class="kt">void</span><span class="o">*</span> <span class="n">disp</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">pRec</span><span class="o">-&gt;</span><span class="n">ExceptionCode</span><span class="o">==</span><span class="mh">0xC000001D</span>  <span class="o">||</span> <span class="n">pRec</span><span class="o">-&gt;</span><span class="n">ExceptionCode</span><span class="o">==</span><span class="mh">0xC000001E</span> <span class="o">||</span> <span class="n">pRec</span><span class="o">-&gt;</span><span class="n">ExceptionCode</span><span class="o">==</span><span class="mh">0xC0000005</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">flag</span><span class="o">=</span><span class="nb">true</span><span class="p">;</span>
        <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="o">*</span><span class="p">)(</span><span class="n">pContext</span><span class="o">+</span><span class="mh">0xB8</span><span class="p">))</span><span class="o">+=</span><span class="mi">5</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">ExceptionContinueExecution</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ExceptionContinueSearch</span><span class="p">;</span>
<span class="p">}</span>
 
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="kr">__asm</span>
    <span class="p">{</span>
        <span class="n">push</span> <span class="n">offset</span> <span class="n">Handler</span>
        <span class="n">push</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">fs</span><span class="o">:</span><span class="p">[</span><span class="mh">0x0</span><span class="p">]</span>
        <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">fs</span><span class="o">:</span><span class="p">[</span><span class="mh">0x0</span><span class="p">],</span><span class="n">esp</span>
    <span class="p">}</span>
    <span class="n">flag</span><span class="o">=</span><span class="nb">false</span><span class="p">;</span>
    <span class="kr">__asm</span>
    <span class="p">{</span>
        <span class="n">__emit</span> <span class="mh">0x0F</span>
        <span class="n">__emit</span> <span class="mh">0xC7</span>
        <span class="n">__emit</span> <span class="mh">0xC8</span>
        <span class="n">__emit</span> <span class="mh">0x05</span>
        <span class="n">__emit</span> <span class="mh">0x00</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">flag</span><span class="o">==</span><span class="nb">false</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">MessageBox</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s">"VirtualPC detected"</span><span class="p">,</span><span class="s">"waliedassar"</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kr">__asm</span>
    <span class="p">{</span>
        <span class="n">pop</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">fs</span><span class="o">:</span><span class="p">[</span><span class="mh">0x0</span><span class="p">]</span>
        <span class="n">pop</span> <span class="n">eax</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p><br /></p>
<h3><a class="a-dummy" name="detecting-environment-via-in-backdoor-port-vmware">6. Detecting environment via IN instruction - backdoor port (VMware only)</a></h3>

<p><a href="https://sites.google.com/site/chitchatvmback/backdoor">This article</a> explains why backdoor port communication is used in VMware in the first place.</p>

<hr class="space" />

<p><b>Code sample (variant 1)</b></p>
<p></p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">bool</span> <span class="n">VMWare</span><span class="o">::</span><span class="n">CheckHypervisorPort</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span>
    <span class="n">bool</span> <span class="n">is_vm</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
    <span class="kr">__try</span> <span class="p">{</span>
        <span class="kr">__asm</span> <span class="p">{</span>
            <span class="n">push</span> <span class="n">edx</span>
            <span class="n">push</span> <span class="n">ecx</span>
            <span class="n">push</span> <span class="n">ebx</span>
            <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="err">'</span><span class="n">VMXh</span><span class="err">'</span>
            <span class="n">mov</span> <span class="n">ebx</span><span class="p">,</span> <span class="mi">0</span>
            <span class="n">mov</span> <span class="n">ecx</span><span class="p">,</span> <span class="mi">10</span>
            <span class="n">mov</span> <span class="n">edx</span><span class="p">,</span> <span class="err">'</span><span class="n">VX</span><span class="err">'</span>
            <span class="n">in</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dx</span>      <span class="c1">// &lt;- key point is here</span>
            <span class="n">cmp</span> <span class="n">ebx</span><span class="p">,</span> <span class="err">'</span><span class="n">VMXh</span><span class="err">'</span>
            <span class="n">setz</span><span class="p">[</span><span class="n">is_vm</span><span class="p">]</span>
            <span class="n">pop</span> <span class="n">ebx</span>
            <span class="n">pop</span> <span class="n">ecx</span>
            <span class="n">pop</span> <span class="n">edx</span>
        <span class="p">}</span>
    <span class="p">}</span> 
    <span class="kr">__except</span> <span class="p">(</span><span class="n">EXCEPTION_EXECUTE_HANDLER</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">is_vm</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">is_vm</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<hr class="space" />

<p><b>Code sample (variant 2)</b></p>
<p></p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">bool</span> <span class="n">VMWare</span><span class="o">::</span><span class="n">CheckHypervisorPortEnum</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span>
    <span class="n">bool</span> <span class="n">is_vm</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
    <span class="kt">short</span> <span class="n">ioports</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span> <span class="err">'</span><span class="n">VX</span><span class="err">'</span> <span class="p">,</span> <span class="err">'</span><span class="n">VY</span><span class="err">'</span> <span class="p">};</span>
    <span class="kt">short</span> <span class="n">ioport</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">short</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">_countof</span><span class="p">(</span><span class="n">ioports</span><span class="p">);</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ioport</span> <span class="o">=</span> <span class="n">ioports</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">cmd</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cmd</span> <span class="o">&lt;</span> <span class="mh">0x2c</span><span class="p">;</span> <span class="o">++</span><span class="n">cmd</span><span class="p">)</span> <span class="p">{</span>
            <span class="kr">__try</span> <span class="p">{</span>
                <span class="kr">__asm</span> <span class="p">{</span>
                    <span class="n">push</span> <span class="n">eax</span>
                    <span class="n">push</span> <span class="n">ebx</span>
                    <span class="n">push</span> <span class="n">ecx</span>
                    <span class="n">push</span> <span class="n">edx</span>
                    <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="err">'</span><span class="n">VMXh</span><span class="err">'</span>
                    <span class="n">movzx</span> <span class="n">ecx</span><span class="p">,</span> <span class="n">cmd</span>
                    <span class="n">mov</span> <span class="n">dx</span><span class="p">,</span> <span class="n">ioport</span>
                    <span class="n">in</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dx</span>      <span class="c1">// &lt;- key point is here</span>
                    <span class="n">pop</span> <span class="n">edx</span>
                    <span class="n">pop</span> <span class="n">ecx</span>
                    <span class="n">pop</span> <span class="n">ebx</span>
                    <span class="n">pop</span> <span class="n">eax</span>
                <span class="p">}</span>
                <span class="n">is_vm</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="kr">__except</span> <span class="p">(</span><span class="n">EXCEPTION_EXECUTE_HANDLER</span><span class="p">)</span> <span class="p">{}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">is_vm</span><span class="p">)</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">is_vm</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<hr class="space" />

<p><br /></p>
<h3><a class="a-dummy" name="signature-recommendations">Signature recommendations</a></h3>

<p><i>No signature recommendations are provided for this evasion group as it’s hard to track such a code being executed.</i></p>

<p><br /></p>
<h3><a class="a-dummy" name="countermeasures-sandboxie">Countermeasures</a></h3>

<p>Patch hypervisor. If it proves impossible — due to license issues or something else — patch VM config. Usually undocumented options help.</p>

<ul>
<li>vs <tt>CPUID</tt> instruction: refer to <a href="http://vknowledge.net/2014/04/17/how-to-fake-a-vms-guest-os-cpuid/">this article</a> for the example of such a patch</li> 
<li>vs <tt>IN</tt> instruction (VMware backdoor): take a look at these <a href="https://wasm.in/threads/izmenenie-raboty-backdoor-interfejsa-v-vmware.24564/#post-291532">config changes</a></li> 
</ul>

<p><br /></p>
<h3><a class="a-dummy" name="credits">Credits</a></h3>

<p>Credits go to open-source project from where code samples were taken and to independent researcher who shared his findings:</p>
<ul>
<li>al-khaser project on <a href="https://github.com/LordNoteworthy/al-khaser">github</a></li>
<li><a href="https://twitter.com/waleedassar">@waleedassar</a></li>
</ul>

<p>Though Check Point tool InviZzzible has them all implemented, due to modular structure of the code it would require more space to show a code sample from this tool for the same purposes. That’s why we’ve decided to use other great open-source projects for examples throughout the encyclopedia.</p>

    <br>
    <div style="text-align: left">
        <a href="..">Go back</a>
    </div>
    <br>
    <div class="sharebuttons" style="text-align: center">
        <hr />
        <ul>
          <li>
            <p class="sharetitle"> Share this: </p>
          </li>
          <li class="reddit">
            <a href="http://www.reddit.com/submit?url=https://evasions.checkpoint.com/src/Evasions/techniques/cpu.html&title=Evasions:%20CPU - Evasion Techniques" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg"
                aria-label="Reddit" role="img"
                viewBox="0 0 512 512"><rect
                width="512" height="512"
                rx="15%"
                fill="#f40"/><g fill="#fff"><ellipse cx="256" cy="307" rx="166" ry="117"/><circle cx="106" cy="256" r="42"/><circle cx="407" cy="256" r="42"/><circle cx="375" cy="114" r="32"/></g><g stroke-linecap="round" stroke-linejoin="round" fill="none"><path d="m256 196 23-101 73 15" stroke="#fff" stroke-width="16"/><path d="m191 359c33 25 97 26 130 0" stroke="#f40" stroke-width="13"/></g><g fill="#f40"><circle cx="191" cy="287" r="31"/><circle cx="321" cy="287" r="31"/></g></svg>
                
            </a>
          </li>
          <li class="hn">
            <a href="http://news.ycombinator.com/submitlink?u=https://evasions.checkpoint.com/src/Evasions/techniques/cpu.html&t=Evasions:%20CPU - Evasion Techniques" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg"
                aria-label="Hacker News" role="img"
                viewBox="0 0 512 512"><rect
                width="512" height="512"
                rx="15%"
                fill="#f60"/><path fill="#fff" d="M124 91h51l81 162 81-164h51L276 293v136h-40V293z"/></svg>
            </a>
          </li>
          <li class="twitter">
            <a href="https://twitter.com/intent/tweet?via=_CPResearch_&url=https://evasions.checkpoint.com/src/Evasions/techniques/cpu.html&text=Evasions:%20CPU - Evasion Techniques" target="_blank">
                <svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"/></svg>
            </a>
          </li>
          <li class="linkedin">
            <a href=https://www.linkedin.com/shareArticle?mini=true&url=https://evasions.checkpoint.com/src/Evasions/techniques/cpu.html&title=Evasions:%20CPU - Evasion Techniques&source=LinkedIn" target="_blank">
                <svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z"/></svg>
            </a>
          </li>
        </ul>
      </div>
      
</article>


</section>

<nav class="navbar navbar-default navbar-fixed-bottom">
  <div class="container footer-content">

    Made with <font class="a-pink"><i class ="fa fa-heart"></i></font> to serve the community by Check Point Research    |    <a class="a-pink" href="https://research.checkpoint.com">Research blog</a>    |    <a class="a-pink" href="https://research.checkpoint.com/about-us/">About Us</a>    |    <a class="a-pink" href="https://github.com/CheckPointSW"><i class="fa fa-github fa-lg"></i></a> <a class="a-pink" href="https://twitter.com/_CPResearch_"><i class="fa fa-twitter fa-lg"></i></a>
    
    <br>
    
    © 1994-2024 Check Point Software Technologies LTD | All rights reserved | Property of CheckPoint.com


  </div>
</nav>

  </body>

</html>
