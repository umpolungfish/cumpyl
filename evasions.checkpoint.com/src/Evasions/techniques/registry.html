<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-194688-3"></script>
  <script>
   window.dataLayer = window.dataLayer || [];
   function gtag(){dataLayer.push(arguments);}
   gtag('js', new Date());
   gtag('config', 'UA-194688-3');
  </script>
  <meta content="Evasion techniques" property="og:site_name">

  <meta content="Evasions: Registry" property="og:title">


  <meta name="twitter:title" content="Malware Evasion Encyclopedia" />
  <meta name="twitter:image" content="https://research.checkpoint.com/wp-content/uploads/2020/02/evasions.jpg" />


  <meta content="article" property="og:type">


  <meta content="Evasion techniques
" property="og:description">


  <meta content="https://evasions.checkpoint.com/src/Evasions/techniques/registry.html" property="og:url">


  <meta content="2024-07-10T07:20:28+00:00" property="article:published_time">
  <meta content="https://evasions.checkpoint.com/about/" property="article:author">


  <meta property="og:image" content="">


  
  <meta content="evasions" property="article:section">
  


  
  <meta content="registry" property="article:tag">
  

  <title>Evasions: Registry</title>
  <meta name="description" content="Contents">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://evasions.checkpoint.com/assets/css/main.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

  <link href='https://fonts.googleapis.com/css?family=PT+Sans' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Fira+Mono' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,200,300,500,600,700,900' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Gentium+Basic:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Alegreya:400,400italic,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Lora:400,400italic,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Fira+Sans:400,300,500,700' rel='stylesheet' type='text/css'>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-hQpvDQiCJaD2H465dQfA717v7lu5qHWtDbWNPvaTJ0ID5xnPUlVXnKzq7b8YUkbN" crossorigin="anonymous">
  <link rel="canonical" href="https://evasions.checkpoint.com/src/Evasions/techniques/registry.html">
  <link rel="alternate" type="application/rss+xml" title="Evasion techniques" href="https://evasions.checkpoint.com/feed.xml">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/tinysort/2.3.6/tinysort.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tinysort/2.3.6/tinysort.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tinysort/2.3.6/tinysort.charorder.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tinysort/2.3.6/tinysort.charorder.min.js"></script>
  <script type="text/javascript" async src="//platform.twitter.com/widgets.js"></script>




</head>


  <body>
<section>
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <div class="jumbotron">
    <div class="container">
      <h1 class="post-title-main" itemprop="name headline">Evasions: Registry</h1>
    </div>
</div>

  <div class="post-content container" itemprop="articleBody">
    <div style="text-align: left">
        <a href="..">Go back</a>
        <br>
        <br>
    </div>
    <h1>Contents</h1>

<p><a href="#registry-detection-methods">Registry detection methods</a>
<br />
  <a href="#check-if-particular-registry-paths-exist">1. Check if particular registry paths exist</a>
<br />
  <a href="#check-if-keys-contain-strings">2. Check if particular registry keys contain specified strings</a>
<br />
  <a href="#check-if-vbawarning-enabled">3. Check if VBAWarnings enabled</a>
<br />
<a href="#countermeasures">Countermeasures</a>
<br />
<a href="#credits">Credits</a>
<br />
<br /></p>

<h2><a class="a-dummy" name="registry-detection-methods">Registry detection methods</a></h2>
<p>The principle of all the registry detection methods is the following: there are no such registry keys and values in usual host. However they exist in particular virtual environments.</p>

<p>Sometimes usual system may cause false positives when these checks are applied because it has some virtual machines installed and thus some VM artifacts are present in the system. Though in all other aspects such a system is treated clean in comparison with virtual environments.</p>

<p>Registry keys may be queries via WinAPI calls.</p>

<p>Functions used in <font face="Courier New">kernel32.dll</font>:</p>
<ul>
  <li><tt>RegOpenKey</tt></li> 
  <li><tt>RegOpenKeyEx</tt></li> 
  <li><tt>RegQueryValue</tt></li> 
  <li><tt>RegQueryValueEx</tt></li> 
  <li><tt>RegCloseKey</tt></li> 
  <li><tt>RegEnumKeyEx</tt></li> 
</ul>

<p>Functions above are wrappers on top of the following <font face="Courier New">ntdll.dll</font> functions:</p>
<ul>
  <li><tt>NtOpenKey</tt></li> 
  <li><tt>NtEnumerateKey</tt></li> 
  <li><tt>NtQueryValueKey</tt></li> 
  <li><tt>NtClose</tt></li> 
</ul>

<p><br /></p>
<h3><a class="a-dummy" name="check-if-particular-registry-paths-exist">1. Check if particular registry paths exist</a></h3>

<p>Take a look at <a href="#registry-detection-methods">title section</a> to get the list of used functions.</p>

<hr class="space" />

<p><b>Code sample</b></p>
<p></p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="cm">/* sample of usage: see detection of VirtualBox in the table below to check registry path */</span>
<span class="kt">int</span> <span class="nf">vbox_reg_key7</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">pafish_exists_regkey</span><span class="p">(</span><span class="n">HKEY_LOCAL_MACHINE</span><span class="p">,</span> <span class="s">"HARDWARE</span><span class="se">\\</span><span class="s">ACPI</span><span class="se">\\</span><span class="s">FADT</span><span class="se">\\</span><span class="s">VBOX__"</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* code is taken from "pafish" project, see references on the parent page */</span>
<span class="kt">int</span> <span class="nf">pafish_exists_regkey</span><span class="p">(</span><span class="n">HKEY</span> <span class="n">hKey</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">regkey_s</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">HKEY</span> <span class="n">regkey</span><span class="p">;</span>
    <span class="n">LONG</span> <span class="n">ret</span><span class="p">;</span>

    <span class="cm">/* regkey_s == "HARDWARE\\ACPI\\FADT\\VBOX__"; */</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pafish_iswow64</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">RegOpenKeyEx</span><span class="p">(</span><span class="n">hKey</span><span class="p">,</span> <span class="n">regkey_s</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">KEY_READ</span> <span class="o">|</span> <span class="n">KEY_WOW64_64KEY</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">regkey</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">RegOpenKeyEx</span><span class="p">(</span><span class="n">hKey</span><span class="p">,</span> <span class="n">regkey_s</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">KEY_READ</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">regkey</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">==</span> <span class="n">ERROR_SUCCESS</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">RegCloseKey</span><span class="p">(</span><span class="n">regkey</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">TRUE</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
        <span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p><i>Credits for this code sample: <a href="https://github.com/a0rtega/pafish">pafish project</a> </i></p>

<hr class="space" />

<p><b>Signature recommendations</b></p>
<p></p>
<p>If the following function contains 2nd argument from the table column <font face="Courier New">`Registry path`</font>:</p>
<p></p>
<ul>
<li><tt>NtOpenKey(..., registry_path, ...)</tt></li> 
</ul>
<p>then it’s an indication of application trying to use the evasion technique.</p>

<hr class="space" />

<p><b>Detections table</b></p>

<table style="width:100%">
  <tr>
  	<td colspan="3">Check if the following registry paths exist:</td>
  </tr>
  <tr>
  	<th style="text-align:center">Detect</th>
  	<th style="text-align:center">Registry path</th>
  	<th style="text-align:center">Details (if any)</th>
  </tr>
  <tr>
  	<th>[general]</th>
  	<td>HKLM\Software\Classes\Folder\shell\sandbox</td>
  	<td />
  </tr>
  <tr>
  	<th rowspan="7">Hyper-V</th>
  	<td>HKLM\SOFTWARE\Microsoft\Hyper-V</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\SOFTWARE\Microsoft\VirtualMachine</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\SOFTWARE\Microsoft\Virtual Machine\Guest\Parameters</td>
  	<td>Usually "HostName" and "VirtualMachineName" values are read under this path</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\vmicheartbeat</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\vmicvss</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\vmicshutdown</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\vmicexchange</td>
  	<td />
  </tr>
  <tr>
  	<th rowspan="1">Parallels</th>
  	<td>HKLM\SYSTEM\CurrentControlSet\Enum\PCI\VEN_1AB8*</td>
  	<td>Subkey has the following structure: VEN_XXXX&amp;DEV_YYYY&amp;SUBSYS_ZZZZ&amp;REV_WW</td>
  </tr>
  <tr>
  	<th rowspan="2">Sandboxie</th>
  	<td>HKLM\SYSTEM\CurrentControlSet\Services\SbieDrv</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Sandboxie</td>
  	<td />
  </tr>
  <tr>
  	<th rowspan="10">VirtualBox</th>
  	<td>HKLM\SYSTEM\CurrentControlSet\Enum\PCI\VEN_80EE*</td>
  	<td>Subkey has the following structure: VEN_XXXX&amp;DEV_YYYY&amp;SUBSYS_ZZZZ&amp;REV_WW</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\ACPI\DSDT\VBOX__</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\ACPI\FADT\VBOX__</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\ACPI\RSDT\VBOX__</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\SOFTWARE\Oracle\VirtualBox Guest Additions</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\VBoxGuest</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\VBoxMouse</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\VBoxService</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\VBoxSF</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\VBoxVideo</td>
  	<td />
  </tr>
  <tr>
  	<th rowspan="5">VirtualPC</th>
  	<td>HKLM\SYSTEM\CurrentControlSet\Enum\PCI\VEN_5333*</td>
  	<td>Subkey has the following structure: VEN_XXXX&amp;DEV_YYYY&amp;SUBSYS_ZZZZ&amp;REV_WW</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\vpcbus</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\vpc-s3</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\vpcuhub</td>
  	<td />
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\msvmmouf</td>
  	<td></td>
  </tr>
  <tr>
  	<th rowspan="14">VMware</th>
  	<td>HKLM\SYSTEM\CurrentControlSet\Enum\PCI\VEN_15AD*</td>
  	<td>Subkey has the following structure: VEN_XXXX&amp;DEV_YYYY&amp;SUBSYS_ZZZZ&amp;REV_WW</td>
  </tr>
  <tr>
  	<td>HKCU\SOFTWARE\VMware, Inc.\VMware Tools</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SOFTWARE\VMware, Inc.\VMware Tools</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\vmdebug</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\vmmouse</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\VMTools</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\VMMEMCTL</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\vmware</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\vmci</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\vmx86</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\CurrentControlSet\Enum\IDE\CdRomNECVMWar_VMware_IDE_CD*</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\CurrentControlSet\Enum\IDE\CdRomNECVMWar_VMware_SATA_CD*</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\CurrentControlSet\Enum\IDE\DiskVMware_Virtual_IDE_Hard_Drive*</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\CurrentControlSet\Enum\IDE\DiskVMware_Virtual_SATA_Hard_Drive*</td>
  	<td></td>
  </tr>
  <tr>
  	<th rowspan="2">Wine</th>
  	<td>HKCU\SOFTWARE\Wine</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SOFTWARE\Wine</td>
  	<td></td>
  </tr>
  <tr>
  	<th rowspan="8">Xen</th>
  	<td>HKLM\HARDWARE\ACPI\DSDT\xen</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\ACPI\FADT\xen</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\ACPI\RSDT\xen</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\xenevtchn</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\xennet</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\xennet6</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\xensvc</td>
  	<td></td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\xenvdb</td>
  	<td></td>
  </tr>
</table>

<p><br />
In particular cases malware may enumerate sub-keys and check if a name of the sub-key contain some string instead of checking if the specified key exists.</p>

<p></p>
<p>For example: enumerate sub-keys of <font face="Courier New">"HKLM\SYSTEM\ControlSet001\Services\"</font> and search for <font face="Courier New">"VBox"</font> string.</p>

<p><br /></p>
<h3><a class="a-dummy" name="check-if-keys-contain-strings">2. Check if particular registry keys contain specified strings</a></h3>

<p>Take a look at <a href="#registry-detection-methods">title section</a> to get the list of used functions. Please note that case is irrelevant for these checks: it may be either upper or lower.</p>

<hr class="space" />

<p><b>Code sample</b></p>
<p></p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="cm">/* sample of usage: see detection of VirtualBox in the table below to check registry path and key values */</span>
<span class="kt">int</span> <span class="nf">vbox_reg_key2</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">pafish_exists_regkey_value_str</span><span class="p">(</span><span class="n">HKEY_LOCAL_MACHINE</span><span class="p">,</span> <span class="s">"HARDWARE</span><span class="se">\\</span><span class="s">Description</span><span class="se">\\</span><span class="s">System"</span><span class="p">,</span> <span class="s">"SystemBiosVersion"</span><span class="p">,</span> <span class="s">"VBOX"</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* code is taken from "pafish" project, see references on the parent page */</span>
<span class="kt">int</span> <span class="nf">pafish_exists_regkey_value_str</span><span class="p">(</span><span class="n">HKEY</span> <span class="n">hKey</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">regkey_s</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">value_s</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">lookup</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/*
        regkey_s == "HARDWARE\\Description\\System";
        value_s == "SystemBiosVersion";
        lookup == "VBOX";
    */</span>

    <span class="n">HKEY</span> <span class="n">regkey</span><span class="p">;</span>
    <span class="n">LONG</span> <span class="n">ret</span><span class="p">;</span>
    <span class="n">DWORD</span> <span class="n">size</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">value</span><span class="p">[</span><span class="mi">1024</span><span class="p">],</span> <span class="o">*</span> <span class="n">lookup_str</span><span class="p">;</span>
    <span class="kt">size_t</span> <span class="n">lookup_size</span><span class="p">;</span>

    <span class="n">lookup_size</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">lookup</span><span class="p">);</span>
    <span class="n">lookup_str</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="n">lookup_size</span><span class="o">+</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
    <span class="n">strncpy</span><span class="p">(</span><span class="n">lookup_str</span><span class="p">,</span> <span class="n">lookup</span><span class="p">,</span> <span class="n">lookup_size</span><span class="o">+</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
    <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>

    <span class="cm">/* regkey_s == "HARDWARE\\Description\\System"; */</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pafish_iswow64</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">RegOpenKeyEx</span><span class="p">(</span><span class="n">hKey</span><span class="p">,</span> <span class="n">regkey_s</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">KEY_READ</span> <span class="o">|</span> <span class="n">KEY_WOW64_64KEY</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">regkey</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">RegOpenKeyEx</span><span class="p">(</span><span class="n">hKey</span><span class="p">,</span> <span class="n">regkey_s</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">KEY_READ</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">regkey</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">==</span> <span class="n">ERROR_SUCCESS</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/* value_s == "SystemBiosVersion"; */</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">RegQueryValueEx</span><span class="p">(</span><span class="n">regkey</span><span class="p">,</span> <span class="n">value_s</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="p">(</span><span class="n">BYTE</span><span class="o">*</span><span class="p">)</span><span class="n">value</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">size</span><span class="p">);</span>
        <span class="n">RegCloseKey</span><span class="p">(</span><span class="n">regkey</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">==</span> <span class="n">ERROR_SUCCESS</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">size_t</span> <span class="n">i</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">strlen</span><span class="p">(</span><span class="n">value</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* case-insensitive */</span>
                <span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">toupper</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">lookup_size</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* case-insensitive */</span>
                <span class="n">lookup_str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">toupper</span><span class="p">(</span><span class="n">lookup_str</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">strstr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">lookup_str</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">free</span><span class="p">(</span><span class="n">lookup_str</span><span class="p">);</span>
                <span class="k">return</span> <span class="n">TRUE</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">free</span><span class="p">(</span><span class="n">lookup_str</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p><i>Credits for this code sample: <a href="https://github.com/a0rtega/pafish">pafish project</a> </i></p>

<hr class="space" />

<p><b>Signature recommendations</b></p>
<p></p>
<p>If the following function contains 2nd argument from the table column <font face="Courier New">`Registry path`</font>:</p>
<p></p>
<ul>
<li><tt>NtOpenKey(..., registry_path, ...)</tt></li> 
</ul>
<p>and is followed by the call to the following function with 2nd argument from the table column <font face="Courier New">`Registry key`</font>:</p>
<ul>
<li><tt>NtQueryValueKey(..., registry_item, ...)</tt></li> 
</ul>
<p>then it’s an indication of application trying to use the evasion technique.</p>

<hr class="space" />

<p><b>Detections table</b></p>

<table style="width:100%">
  <tr>
  	<td colspan="4">Check if the following registry values contain the following strings (case insensitive):</td>
  </tr>
  <tr>
  	<th style="text-align:center">Detect</th>
  	<th style="text-align:center">Registry path</th>
  	<th style="text-align:center">Registry key</th>
  	<th style="text-align:center">String</th>
  </tr>
  <tr>
  	<th rowspan="2">[general]</th>
  	<td>HKLM\HARDWARE\Description\System</td>
  	<td>SystemBiosDate</td>
  	<td>06/23/99</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\Description\System\BIOS</td>
  	<td>SystemProductName</td>
  	<td>A M I</td>
  </tr>
  <tr>
  	<th rowspan="2">BOCHS</th>
  	<td>HKLM\HARDWARE\Description\System</td>
  	<td>SystemBiosVersion</td>
  	<td>BOCHS</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\Description\System</td>
  	<td>VideoBiosVersion</td>
  	<td>BOCHS</td>
  </tr>
  <tr>
  	<th rowspan="2">Anubis</th>
  	<td>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion</td>
  	<td>ProductID</td>
  	<td>76487-337-8429955-22614</td>
  </tr>
  <tr>
  	<td>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion</td>
  	<td>ProductID</td>
  	<td>76487-337-8429955-22614</td>
  </tr>
  <tr>
  	<th rowspan="2">CwSandbox</th>
  	<td>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion</td>
  	<td>ProductID</td>
  	<td>76487-644-3177037-23510</td>
  </tr>
  <tr>
  	<td>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion</td>
  	<td>ProductID</td>
  	<td>76487-644-3177037-23510</td>
  </tr>
  <tr>
  	<th rowspan="2">JoeBox</th>
  	<td>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion</td>
  	<td>ProductID</td>
  	<td>55274-640-2673064-23950</td>
  </tr>
  <tr>
  	<td>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion</td>
  	<td>ProductID</td>
  	<td>55274-640-2673064-23950</td>
  </tr>
  <tr>
  	<th rowspan="2">Parallels</th>
  	<td>HKLM\HARDWARE\Description\System</td>
  	<td>SystemBiosVersion</td>
  	<td>PARALLELS</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\Description\System</td>
  	<td>VideoBiosVersion</td>
  	<td>PARALLELS</td>
  </tr>
  <tr>
  	<th rowspan="4">QEMU</th>
  	<td>HKLM\HARDWARE\DEVICEMAP\Scsi\Scsi Port 0\Scsi Bus 0\Target Id 0\Logical Unit Id 0</td>
  	<td>Identifier</td>
  	<td>QEMU</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\Description\System</td>
  	<td>SystemBiosVersion</td>
  	<td>QEMU</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\Description\System</td>
  	<td>VideoBiosVersion</td>
  	<td>QEMU</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\Description\System\BIOS</td>
  	<td>SystemManufacturer</td>
  	<td>QEMU</td>
  </tr>
  <tr>
  	<th rowspan="14">VirtualBox</th>
  	<td>HKLM\HARDWARE\DEVICEMAP\Scsi\Scsi Port 0\Scsi Bus 0\Target Id 0\Logical Unit Id 0</td>
  	<td>Identifier</td>
  	<td>VBOX</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\DEVICEMAP\Scsi\Scsi Port 1\Scsi Bus 0\Target Id 0\Logical Unit Id 0</td>
  	<td>Identifier</td>
  	<td>VBOX</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\DEVICEMAP\Scsi\Scsi Port 2\Scsi Bus 0\Target Id 0\Logical Unit Id 0</td>
  	<td>Identifier</td>
  	<td>VBOX</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\Description\System</td>
  	<td>SystemBiosVersion</td>
  	<td>VBOX</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\Description\System</td>
  	<td>VideoBiosVersion</td>
  	<td>VIRTUALBOX</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\Description\System\BIOS</td>
  	<td>SystemProductName</td>
  	<td>VIRTUAL</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\Disk\Enum</td>
  	<td>DeviceDesc</td>
  	<td>VBOX</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\Disk\Enum</td>
  	<td>FriendlyName</td>
  	<td>VBOX</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet002\Services\Disk\Enum</td>
  	<td>DeviceDesc</td>
  	<td>VBOX</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet002\Services\Disk\Enum</td>
  	<td>FriendlyName</td>
  	<td>VBOX</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet003\Services\Disk\Enum</td>
  	<td>DeviceDesc</td>
  	<td>VBOX</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet003\Services\Disk\Enum</td>
  	<td>FriendlyName</td>
  	<td>VBOX</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\CurrentControlSet\Control\SystemInformation</td>
  	<td>SystemProductName</td>
  	<td>VIRTUAL</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\CurrentControlSet\Control\SystemInformation</td>
  	<td>SystemProductName</td>
  	<td>VIRTUALBOX</td>
  </tr>
  <tr>
  	<th rowspan="28">VMware</th>
  	<td>HKLM\HARDWARE\DEVICEMAP\Scsi\Scsi Port 0\Scsi Bus 0\Target Id 0\Logical Unit Id 0</td>
  	<td>Identifier</td>
  	<td>VMWARE</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\DEVICEMAP\Scsi\Scsi Port 1\Scsi Bus 0\Target Id 0\Logical Unit Id 0</td>
  	<td>Identifier</td>
  	<td>VMWARE</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\DEVICEMAP\Scsi\Scsi Port 2\Scsi Bus 0\Target Id 0\Logical Unit Id 0</td>
  	<td>Identifier</td>
  	<td>VMWARE</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\Description\System</td>
  	<td>SystemBiosVersion</td>
  	<td>VMWARE</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\Description\System</td>
  	<td>SystemBiosVersion</td>
  	<td>INTEL - 6040000</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\Description\System</td>
  	<td>VideoBiosVersion</td>
  	<td>VMWARE</td>
  </tr>
  <tr>
  	<td>HKLM\HARDWARE\Description\System\BIOS</td>
  	<td>SystemProductName</td>
  	<td>VMware</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\Disk\Enum</td>
  	<td>0</td>
  	<td>VMware</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\Disk\Enum</td>
  	<td>1</td>
  	<td>VMware</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\Disk\Enum</td>
  	<td>DeviceDesc</td>
  	<td>VMware</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Services\Disk\Enum</td>
  	<td>FriendlyName</td>
  	<td>VMware</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet002\Services\Disk\Enum</td>
  	<td>DeviceDesc</td>
  	<td>VMware</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet002\Services\Disk\Enum</td>
  	<td>FriendlyName</td>
  	<td>VMware</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet003\Services\Disk\Enum</td>
  	<td>DeviceDesc</td>
  	<td>VMware</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet003\Services\Disk\Enum</td>
  	<td>FriendlyName</td>
  	<td>VMware</td>
  </tr>
  <tr>
  	<td>HKCR\Installer\Products</td>
  	<td>ProductName</td>
  	<td>vmware tools</td>
  </tr>
  <tr>
  	<td>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall</td>
  	<td>DisplayName</td>
  	<td>vmware tools</td>
  </tr>
  <tr>
  	<td>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall</td>
  	<td>DisplayName</td>
  	<td>vmware tools</td>
  </tr>
  <tr>
  	<td>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall</td>
  	<td>DisplayName</td>
  	<td>vmware tools</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Control\Class\{4D36E968-E325-11CE-BFC1-08002BE10318}\0000</td>
  	<td>CoInstallers32</td>
  	<td>*vmx*</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Control\Class\{4D36E968-E325-11CE-BFC1-08002BE10318}\0000</td>
  	<td>DriverDesc</td>
  	<td>VMware*</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Control\Class\{4D36E968-E325-11CE-BFC1-08002BE10318}\0000</td>
  	<td>InfSection</td>
  	<td>vmx*</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Control\Class\{4D36E968-E325-11CE-BFC1-08002BE10318}\0000</td>
  	<td>ProviderName</td>
  	<td>VMware*</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\ControlSet001\Control\Class\{4D36E968-E325-11CE-BFC1-08002BE10318}\0000\Settings</td>
  	<td>Device Description</td>
  	<td>VMware*</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\CurrentControlSet\Control\SystemInformation</td>
  	<td>SystemProductName</td>
  	<td>VMWARE</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\CurrentControlSet\Control\Video\{GUID}\Video</td>
  	<td>Service</td>
  	<td>vm3dmp</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\CurrentControlSet\Control\Video\{GUID}\Video</td>
  	<td>Service</td>
  	<td>vmx_svga</td>
  </tr>
  <tr>
  	<td>HKLM\SYSTEM\CurrentControlSet\Control\Video\{GUID}\0000</td>
  	<td>Device Description</td>
  	<td>VMware SVGA*</td>
  </tr>
  <tr>
  	<th rowspan="1">Xen</th>
  	<td>HKLM\HARDWARE\Description\System\BIOS</td>
  	<td>SystemProductName</td>
  	<td>Xen</td>
  </tr>
</table>

<hr class="space" />

<p><br /></p>
<h3><a class="a-dummy" name="check-if-vbawarning-enabled">3. Check if VBAWarnings enabled</a></h3>

<p>“Enable all macros” prompt in Office documents means the macros can be executed without any user interaction. This behavior is common for sandboxes.
A malware can use that in order to check if it is running on a sandbox checking the flag in the registry keys  <tt>SOFTWARE\Microsoft\Office&lt;version&gt;\Word\Security\VBAWarnings</tt> while the version is between 12.0 to 19.0.</p>

<hr class="space" />

<p><b>Code sample</b></p>
<p></p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="c1">// Function to check if VBScript warnings are enabled in Office</span>
<span class="n">bool</span> <span class="nf">IsVBScriptWarningEnabled</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">HKEY</span> <span class="n">hKey</span><span class="p">;</span>
    <span class="n">LPCWSTR</span> <span class="n">keyPath</span> <span class="o">=</span> <span class="s">L"SOFTWARE</span><span class="se">\\</span><span class="s">Microsoft</span><span class="se">\\</span><span class="s">Office</span><span class="se">\\</span><span class="s">&lt;Office_Version&gt;</span><span class="se">\\</span><span class="s">Common</span><span class="se">\\</span><span class="s">Security"</span><span class="p">;</span>
    <span class="n">LPCWSTR</span> <span class="n">valueName</span> <span class="o">=</span> <span class="s">L"VBAScriptWarnings"</span><span class="p">;</span>

    <span class="c1">// Open the registry key</span>
    <span class="n">LONG</span> <span class="n">result</span> <span class="o">=</span> <span class="n">RegOpenKeyEx</span><span class="p">(</span><span class="n">HKEY_CURRENT_USER</span><span class="p">,</span> <span class="n">keyPath</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">KEY_READ</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hKey</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="n">ERROR_SUCCESS</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">DWORD</span> <span class="n">dwType</span><span class="p">;</span>
        <span class="n">DWORD</span> <span class="n">dwValue</span><span class="p">;</span>
        <span class="n">DWORD</span> <span class="n">dwSize</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">DWORD</span><span class="p">);</span>

        <span class="c1">// Query the value of VBAScriptWarnings</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">RegQueryValueEx</span><span class="p">(</span><span class="n">hKey</span><span class="p">,</span> <span class="n">valueName</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dwType</span><span class="p">,</span> <span class="n">reinterpret_cast</span><span class="o">&lt;</span><span class="n">LPBYTE</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">dwValue</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">dwSize</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="n">ERROR_SUCCESS</span> <span class="o">&amp;&amp;</span> <span class="n">dwType</span> <span class="o">==</span> <span class="n">REG_DWORD</span> <span class="o">&amp;&amp;</span> <span class="n">dwValue</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// VBScript warnings are enabled</span>
            <span class="n">RegCloseKey</span><span class="p">(</span><span class="n">hKey</span><span class="p">);</span>
            <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">RegCloseKey</span><span class="p">(</span><span class="n">hKey</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">IsVBScriptWarningEnabled</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"VBScript warnings are enabled in Office."</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"VBScript warnings are not enabled in Office."</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p><br /></p>
<h3><a class="a-dummy" name="countermeasures">Countermeasures</a></h3>

<p>Hook target functions and return appropriate results if indicators (registry strings from tables) are checked.</p>

<p><br /></p>
<h3><a class="a-dummy" name="credits">Credits</a></h3>

<p>Credits go to open-source project from where code samples were taken:</p>
<ul>
<li>pafish project on <a href="https://github.com/a0rtega/pafish">github</a></li>
</ul>

<p>Though Check Point tool InviZzzible has them all implemented, due to modular structure of the code it would require more space to show a code sample from this tool for the same purposes. That’s why we’ve decided to use other great open-source projects for examples throughout the encyclopedia.</p>


    <br>
    <div style="text-align: left">
        <a href="..">Go back</a>
    </div>
    <br>
    <div class="sharebuttons" style="text-align: center">
        <hr />
        <ul>
          <li>
            <p class="sharetitle"> Share this: </p>
          </li>
          <li class="reddit">
            <a href="http://www.reddit.com/submit?url=https://evasions.checkpoint.com/src/Evasions/techniques/registry.html&title=Evasions:%20Registry - Evasion Techniques" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg"
                aria-label="Reddit" role="img"
                viewBox="0 0 512 512"><rect
                width="512" height="512"
                rx="15%"
                fill="#f40"/><g fill="#fff"><ellipse cx="256" cy="307" rx="166" ry="117"/><circle cx="106" cy="256" r="42"/><circle cx="407" cy="256" r="42"/><circle cx="375" cy="114" r="32"/></g><g stroke-linecap="round" stroke-linejoin="round" fill="none"><path d="m256 196 23-101 73 15" stroke="#fff" stroke-width="16"/><path d="m191 359c33 25 97 26 130 0" stroke="#f40" stroke-width="13"/></g><g fill="#f40"><circle cx="191" cy="287" r="31"/><circle cx="321" cy="287" r="31"/></g></svg>
                
            </a>
          </li>
          <li class="hn">
            <a href="http://news.ycombinator.com/submitlink?u=https://evasions.checkpoint.com/src/Evasions/techniques/registry.html&t=Evasions:%20Registry - Evasion Techniques" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg"
                aria-label="Hacker News" role="img"
                viewBox="0 0 512 512"><rect
                width="512" height="512"
                rx="15%"
                fill="#f60"/><path fill="#fff" d="M124 91h51l81 162 81-164h51L276 293v136h-40V293z"/></svg>
            </a>
          </li>
          <li class="twitter">
            <a href="https://twitter.com/intent/tweet?via=_CPResearch_&url=https://evasions.checkpoint.com/src/Evasions/techniques/registry.html&text=Evasions:%20Registry - Evasion Techniques" target="_blank">
                <svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"/></svg>
            </a>
          </li>
          <li class="linkedin">
            <a href=https://www.linkedin.com/shareArticle?mini=true&url=https://evasions.checkpoint.com/src/Evasions/techniques/registry.html&title=Evasions:%20Registry - Evasion Techniques&source=LinkedIn" target="_blank">
                <svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z"/></svg>
            </a>
          </li>
        </ul>
      </div>
      
</article>


</section>

<nav class="navbar navbar-default navbar-fixed-bottom">
  <div class="container footer-content">

    Made with <font class="a-pink"><i class ="fa fa-heart"></i></font> to serve the community by Check Point Research    |    <a class="a-pink" href="https://research.checkpoint.com">Research blog</a>    |    <a class="a-pink" href="https://research.checkpoint.com/about-us/">About Us</a>    |    <a class="a-pink" href="https://github.com/CheckPointSW"><i class="fa fa-github fa-lg"></i></a> <a class="a-pink" href="https://twitter.com/_CPResearch_"><i class="fa fa-twitter fa-lg"></i></a>
    
    <br>
    
    © 1994-2024 Check Point Software Technologies LTD | All rights reserved | Property of CheckPoint.com


  </div>
</nav>

  </body>

</html>
